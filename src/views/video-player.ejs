<%- include('layouts/default/head') %>

<%- include('layouts/default/header') %>

<br />

<div class="container">
    <div class="embed-responsive embed-responsive-16by9">
        <video src="/video/<%= video.id %>/stream" controls></video>
    </div>
</div>

<br />

<div class="container">
    <h2><%= video.title %></h2>
    <h6><%= video.view_count %> views</h6>
    <h6><%= video.like_count %> likes <%= video.dislike_count %> dislikes</h6>
    <h6>Published on <%= video.upload_date.getDate() %>/<%= video.upload_date.getMonth() + 1 %>/<%= video.upload_date.getFullYear() %></h6>

    <br />

    <p>
        <%- video.description.replace(/\n/g, '<br />') %>
    </p>
</div>

<br />

<div class="container">
    <h4>Comments</h4>
    <div>
        <% comments.forEach(function(comment, index) { %>
            <div class="media mb-3">
                <img src="/avatars/<%= comment.author_id %>.jpg" class="mr-3 rounded-circle" width="64" height="64" />
                <div class="media-body">
                    <h5 class="mt-0"><%= comment.author_name %></h5>
                    <%= comment.content %><br />
                    👍 <%= comment.like_count %>

                    <% comment.children.forEach(function(child) { %>
                        <div class="media mt-3">
                            <img src="/avatars/<%= child.author_id %>.jpg" class="mr-3 rounded-circle" width="64" height="64" />
                            <div class="media-body">
                                <h5 class="mt-0"><%= child.author_name %></h5>
                                <%= child.content %><br />

                                👍 <%= child.like_count %>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </div>
        <% }) %>
    </div>
</div>

<%- include('layouts/default/foot') %>
